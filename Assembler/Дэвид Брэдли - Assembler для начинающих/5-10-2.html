<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
</head>
<body background="../bgrwhite.gif">
<p><div align="center"><b><a name="5-10-2">EXTRN и PUBLIC
</a></b></div></p>

<p><span
style="mso-spacerun: yes">    </span>Редактор связей не может, однако,
выполнить все, о чем говорилось

<p><span
style="mso-spacerun: yes">    </span>выше, самостоятельно.<span
style="mso-spacerun: yes">  </span>Ассемблер должен получить от программиста

<p><span
style="mso-spacerun: yes">    </span>информацию о подпрограммах, относящихся к
другому программному

<p><span
style="mso-spacerun: yes">    </span>модулю.<span style="mso-spacerun: yes"> 
</span>Это ввполняется с помощью оператора PUBLIC, извещающего

<p><span
style="mso-spacerun: yes">    </span>ассемблер о том, что данное символическое
имя доступно другим

<p><span
style="mso-spacerun: yes">    </span>программам.<span style="mso-spacerun:
yes">  </span>Кроме того, программист указывает ассмеблеру, какие из

<p><span
style="mso-spacerun: yes">    </span>символических имен является внешними для
данного программного

<p><span
style="mso-spacerun: yes">    </span>модуля.<span style="mso-spacerun: yes"> 
</span>В языке ассемблера это реализуется оператором EXTRN,

<p><span
style="mso-spacerun: yes">    </span>который объявляет соответствующее имя
внешним для текущего

<p><span
style="mso-spacerun: yes">    </span>ассемблирования, чтобы оно могло быть
правильно обработано.

<p><span
style="mso-spacerun: yes">    </span>Ассемблер помечает данную команду таким
образом, чтобы редактор

<p><span
style="mso-spacerun: yes">    </span>связей мог впоследствии найти ее и
вставить туда правильное

<p><span
style="mso-spacerun: yes">    </span>значение адреса.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>Оператор EXTRN выполняет две фуекции.
Во-первых, он сообщает

<p><span
style="mso-spacerun: yes">    </span>ассемблеру, что указанное символическое
имя является внешним для

<p><span
style="mso-spacerun: yes">    </span>текущего ассемблирования. Конечно, на этом
этапе ассемблер мог бы

<p><span
style="mso-spacerun: yes">    </span>считать, что любое имя, не
идентифицированное им в процессе

<p><span
style="mso-spacerun: yes">    </span>ассемблирования, является внешним. Однако,
если когда-нибудь вы

<p><span
style="mso-spacerun: yes">    </span>ошиблись в указании имен, то ассемблер
решит, что имеется в виду

<p><span
style="mso-spacerun: yes">    </span>внешнее имя, и не выдает сообщения об
ошибке. Это отложит индикацию

<p><span
style="mso-spacerun: yes">    </span>ошибки до этапа редактирования связей. Для
большинства

<p><span
style="mso-spacerun: yes">    </span>программистов это слишком поздно,
особенно, если речь идет о чем-то

<p><span
style="mso-spacerun: yes">    </span>простом, вроде описки. Таким образом,
ассемблер индицирует ошибку в

<p><span
style="mso-spacerun: yes">    </span>случае любого не определенного им
символического имени.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>Вторая функция оператора EXTRN состоит в
том, что он указывает

<p><span
style="mso-spacerun: yes">    </span>ассемблеру тип соответствующего
символического имени. Так как

<p><span
style="mso-spacerun: yes">    </span>ассемблирование является очень формальной
процедурой, то ассемблер

<p><span
style="mso-spacerun: yes">    </span>должен знать, что представляет из себя
каждый символ. Это позволяет

<p><span
style="mso-spacerun: yes">    </span>ему генерировать правильные команды. В
случае данных оператор EXTRN

<p><span
style="mso-spacerun: yes">    </span>может указывать на байт, двойное слово или
другой типовой элемент.

<p><span
style="mso-spacerun: yes">    </span>Тип имени подпрограммы или другой
программной метки может быть либо

<p><span
style="mso-spacerun: yes">    </span>NEAR, либо FAR, в зависимости от того, в
каком сегменте она

<p><span
style="mso-spacerun: yes">    </span>находится. От программиста требуется
указать в операторе EXTRN тип

<p><span
style="mso-spacerun: yes">    </span>символического имени. Так как кроме того
ассемблером осуществляется

<p><span
style="mso-spacerun: yes">    </span>посегментная адресация программы, то
оператор EXTERN указывает на

<p><span
style="mso-spacerun: yes">    </span>сегмент, в котором появляется данный
идентификатор. Это не входит в

<p><span
style="mso-spacerun: yes">    </span>синтаксис оператора EXTRN, а определяется
местоположением этого

<p><span
style="mso-spacerun: yes">    </span>оператора в программе. Ассемблер считает,
что внешнее имя относится

<p><span
style="mso-spacerun: yes">    </span>к тому же сегменту, в котором появляется
оператор EXTERN для этого

<p><span
style="mso-spacerun: yes">    </span>символического имени.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>На Фиг. 5.13 приведен пример ассемблерной
программы,

<p><span
style="mso-spacerun: yes">    </span>иллюстрирующей использование оператора
EXTRN. Здесь имеются два

<p><span
style="mso-spacerun: yes">    </span>имени, являющиеся внешними для данной
программы. OUTPUT_CHARACTER

<p><span
style="mso-spacerun: yes">    </span>обозначает однобайтовую переменную.
Соответствующий этой переменной

<p><span
style="mso-spacerun: yes">    </span>атрибут &quot;:BYTE&quot; указывается
после имени переменной. Указатель NEAR

<p><span
style="mso-spacerun: yes">    </span>программной метки OUTPUT_ROUTINE говорит о
том, что она находится в

<p><span
style="mso-spacerun: yes">    </span>том же сегменте. Хотя приведенная на Фиг.
5.13 прогграмма содержит

<p><span
style="mso-spacerun: yes">    </span>ссылки на эти символические имена, при
трансляции ассемблер знает,

<p><span
style="mso-spacerun: yes">    </span>как ему сегментировать правильные команды.
Если бы оператор EXTRN

<p><span
style="mso-spacerun: yes">    </span>отсутствовал в программе, то в этом случае
ассемблер

<p><span
style="mso-spacerun: yes">    </span>инициализировал бы ошибки. Из
ассемблерного листинга видно, что

<p><span
style="mso-spacerun: yes">    </span>после поля адреса в командах, ссылающихся
на внешние имена, стоит

<p><span
style="mso-spacerun: yes">    </span>символ E.

<p>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>icrosoft (R) Macro Assembler Version 5.00 <span style='mso-tab-count:
2'>            </span><span style="mso-spacerun: yes"> </span>4/2/89<span
style="mso-spacerun: yes">  </span>16:06:36

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>Фиг. 5.13 Основная программа<span style='mso-tab-count:4'>                    </span><span
style="mso-spacerun: yes">  </span>Page<span style='mso-tab-count:1'>      </span><span
style="mso-spacerun: yes">   </span>1-1

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">      </span>PAGE<span style="mso-spacerun: yes">   
</span>,132

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">      </span>TITLE<span style="mso-spacerun: yes">  
</span>Фиг. 5.13 Основная программа

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0000<span style='mso-tab-count:3'>             </span><span
style="mso-spacerun: yes">      </span>STACK<span style="mso-spacerun: yes">  
</span>SEGMENT STACK

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0000<span style="mso-spacerun: yes">  </span>0040[<span
style='mso-tab-count:3'>                  </span><span style="mso-spacerun:
yes">      </span>DW<span style="mso-spacerun: yes">      </span>64 DUP (?)<span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>; Резервирование места для стека

<p><span
style='mso-tab-count:3'>                  </span><span style="mso-spacerun:
yes"> </span>????

<p><span
style='mso-tab-count:4'>                        </span><span
style="mso-spacerun: yes">       </span>]

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0080<span style='mso-tab-count:3'>             </span><span
style="mso-spacerun: yes">      </span>STACK<span style="mso-spacerun: yes">  
</span>ENDS

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0000<span style='mso-tab-count:3'>             </span><span
style="mso-spacerun: yes">      </span>CODE<span style="mso-spacerun: yes">   
</span>SEGMENT PUBLIC

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">      </span>EXTRN<span style="mso-spacerun: yes">  
</span>OUTPUT_ROUTINE:NEAR, OUTPUT_CHARACTER:BYTE

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">      </span>ASSUME<span style="mso-spacerun: yes"> 
</span>CS:CODE

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0000<span style='mso-tab-count:3'>             </span><span
style="mso-spacerun: yes">      </span>START<span style="mso-spacerun: yes">  
</span>PROC<span style="mso-spacerun: yes">    </span>FAR

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0000<span style="mso-spacerun: yes">  </span>1E <span style='mso-tab-count:
3'>              </span><span style="mso-spacerun: yes">      </span>PUSH<span
style="mso-spacerun: yes">    </span>DS<span style='mso-tab-count:2'>        </span><span
style="mso-spacerun: yes">      </span>; Сегмент адреса возврата

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0001<span style="mso-spacerun: yes">  </span>B8 0000<span
style='mso-tab-count:3'>                </span><span style="mso-spacerun:
yes">      </span>MOV<span style="mso-spacerun: yes">     </span>AX, 0

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0004<span style="mso-spacerun: yes">  </span>50 <span style='mso-tab-count:
3'>              </span><span style="mso-spacerun: yes">      </span>PUSH<span
style="mso-spacerun: yes">    </span>AX<span style='mso-tab-count:2'>        </span><span
style="mso-spacerun: yes">      </span>; Смещение адреса возврата

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0005<span style="mso-spacerun: yes">  </span>FC <span style='mso-tab-count:
3'>              </span><span style="mso-spacerun: yes">      </span>CLD<span
style='mso-tab-count:3'>               </span><span style="mso-spacerun:
yes">      </span>; Установка направления

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0006<span style="mso-spacerun: yes">  </span>8C C8<span
style='mso-tab-count:3'>                  </span><span style="mso-spacerun:
yes">      </span>MOV<span style="mso-spacerun: yes">     </span>AX, CS<span
style='mso-tab-count:2'>          </span><span style="mso-spacerun: yes">     
</span>; Установка сегментного регистра

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0008<span style="mso-spacerun: yes">  </span>8E D8<span
style='mso-tab-count:3'>                  </span><span style="mso-spacerun:
yes">      </span>MOV<span style="mso-spacerun: yes">     </span>DS, AX

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">      </span>ASSUME<span style="mso-spacerun: yes"> 
</span>DS:CODE<span style='mso-tab-count:2'>         </span><span
style="mso-spacerun: yes">      </span>; Индикация состояния регистра

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>000A<span style="mso-spacerun: yes">  </span>8D 36 001D R<span
style='mso-tab-count:2'>           </span><span style="mso-spacerun: yes">     
</span>LEA<span style="mso-spacerun: yes">     </span>SI, MESSAGE<span
style='mso-tab-count:1'>     </span><span style="mso-spacerun: yes">     
</span>; Адрес строки сообщения

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>000E<span style='mso-tab-count:3'>             </span><span
style="mso-spacerun: yes">      </span>CLOOP:

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>000E<span style="mso-spacerun: yes">  </span>AC <span style='mso-tab-count:
3'>              </span><span style="mso-spacerun: yes">      </span>LODSB<span
style='mso-tab-count:3'>             </span><span style="mso-spacerun:
yes">      </span>; Выборка следующего байта сообщения

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>000F<span style="mso-spacerun: yes">  </span>A2 0000 E<span
style='mso-tab-count:3'>              </span><span style="mso-spacerun:
yes">      </span>MOV<span style="mso-spacerun: yes">    
</span>OUTPUT_CHARACTER, AL<span style="mso-spacerun: yes">    </span>;
Сохранение в памяти символа

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0012<span style="mso-spacerun: yes">  </span>E8 0000 E<span
style='mso-tab-count:3'>              </span><span style="mso-spacerun:
yes">      </span>CALL<span style="mso-spacerun: yes">    </span>OUTPUT_ROUTINE<span
style='mso-tab-count:1'>  </span><span style="mso-spacerun: yes">      </span>;
Вывод символа

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0015<span style="mso-spacerun: yes">  </span>80 3E 0000 E 0A<span
style='mso-tab-count:2'>        </span><span style="mso-spacerun: yes">     
</span>CMP<span style="mso-spacerun: yes">     </span>OUTPUT_CHARACTER, 10<span
style="mso-spacerun: yes">    </span>; Проверка на символ конца сообщения

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>001A<span style="mso-spacerun: yes">  </span>75 F2<span
style='mso-tab-count:3'>                  </span><span style="mso-spacerun:
yes">      </span>JNE<span style="mso-spacerun: yes">     </span>CLOOP<span
style='mso-tab-count:2'>           </span><span style="mso-spacerun: yes">     
</span>; Обработка следующего символа

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>001C<span style="mso-spacerun: yes">  </span>CB <span style='mso-tab-count:
3'>              </span><span style="mso-spacerun: yes">      </span>RET<span
style='mso-tab-count:3'>               </span><span style="mso-spacerun:
yes">      </span>; Возврат в ДОС

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>001D<span style="mso-spacerun: yes">  </span>9D E2 A0 20 AF E0 AE<span
style="mso-spacerun: yes">     </span>MESSAGE DB<span style="mso-spacerun:
yes">      </span>'Эта программа - тест', 13, 10

<p><span
style='mso-tab-count:2'>            </span><span style="mso-spacerun: yes">    
</span>A3 E0 A0 AC AC A0 20

<p><span
style='mso-tab-count:2'>            </span><span style="mso-spacerun: yes">    
</span>2D 20 E2 A5 E1 E2 0D

<p><span
style='mso-tab-count:2'>            </span><span style="mso-spacerun: yes">    
</span>0A

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0033<span style='mso-tab-count:3'>             </span><span
style="mso-spacerun: yes">      </span>START<span style="mso-spacerun: yes">  
</span>ENDP

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0033<span style='mso-tab-count:3'>             </span><span
style="mso-spacerun: yes">      </span>CODE<span style="mso-spacerun: yes">   
</span>ENDS

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">      </span>END<span style="mso-spacerun: yes">    
</span>START&#18;

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:2'>            </span>Фиг. 5.13 Главная процедура


<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>Microsoft (R) Macro Assembler Version 5.00<span style='mso-tab-count:
2'>            </span><span style="mso-spacerun: yes">  </span>1/1/80 04:02:28

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>Фиг. 5.14 Подпрограмма вывода<span style='mso-tab-count:4'>                   </span><span
style="mso-spacerun: yes">  </span>Page<span style='mso-tab-count:1'>      </span><span
style="mso-spacerun: yes">   </span>1-1

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">      </span>PAGE<span style="mso-spacerun: yes">   
</span>,132

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">      </span>TITLE<span style="mso-spacerun: yes">  
</span>Фиг. 5.14 Подпрограмма вывода

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0000<span style='mso-tab-count:3'>             </span><span
style="mso-spacerun: yes">      </span>CODE<span style="mso-spacerun: yes">   
</span>SEGMENT PUBLIC

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">      </span>ASSUME<span style="mso-spacerun: yes"> 
</span>CS:CODE,DS:CODE<span style='mso-tab-count:1'> </span><span
style="mso-spacerun: yes">      </span>; Это должно быть так при вызове

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">      </span>PUBLIC<span style="mso-spacerun: yes"> 
</span>OUTPUT_CHARACTER, OUTPUT_ROUTINE

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0000<span style="mso-spacerun: yes">  </span>?? <span style='mso-tab-count:
2'>        </span><span style="mso-spacerun: yes">      </span>OUTPUT_CHARACTER<span
style='mso-tab-count:1'>  </span><span style="mso-spacerun: yes">     
</span>DB<span style="mso-spacerun: yes">      </span>?

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0001<span style='mso-tab-count:3'>             </span><span
style="mso-spacerun: yes">      </span>OUTPUT_ROUTINE<span style="mso-spacerun:
yes">  </span>PROC<span style="mso-spacerun: yes">    </span>NEAR

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0001<span style="mso-spacerun: yes">  </span>A0 0000 R<span
style='mso-tab-count:3'>              </span><span style="mso-spacerun:
yes">      </span>MOV<span style="mso-spacerun: yes">     </span>AL,
OUTPUT_CHARACTER<span style="mso-spacerun: yes">    </span>; Выборка выводимого
символа

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0004<span style="mso-spacerun: yes">  </span>B4 0E<span
style='mso-tab-count:3'>                  </span><span style="mso-spacerun:
yes">      </span>MOV<span style="mso-spacerun: yes">     </span>AH, 14<span
style='mso-tab-count:2'>          </span><span style="mso-spacerun: yes">     
</span>; Функция вывода в BIOS

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0006<span style="mso-spacerun: yes">  </span>BB 0000<span
style='mso-tab-count:3'>                </span><span style="mso-spacerun:
yes">      </span>MOV<span style="mso-spacerun: yes">     </span>BX, 0<span
style='mso-tab-count:2'>           </span><span style="mso-spacerun: yes">     
</span>; Установка номера страницы

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>0009<span style="mso-spacerun: yes">  </span>BA 0000<span
style='mso-tab-count:3'>                </span><span style="mso-spacerun:
yes">      </span>MOV<span style="mso-spacerun: yes">     </span>DX, 0

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>000C<span style="mso-spacerun: yes">  </span>CD 10<span
style='mso-tab-count:3'>                  </span><span style="mso-spacerun:
yes">      </span>INT<span style="mso-spacerun: yes">     </span>10H<span
style='mso-tab-count:2'>       </span><span style="mso-spacerun: yes">     
</span>; Вызов подпрограммы вывода на экран

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>000E<span style="mso-spacerun: yes">  </span>C3 <span style='mso-tab-count:
3'>              </span><span style="mso-spacerun: yes">      </span>RET<span
style='mso-tab-count:3'>               </span><span style="mso-spacerun:
yes">      </span>; Возврат в вызывающую программу

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>000F<span style='mso-tab-count:3'>             </span><span
style="mso-spacerun: yes">      </span>OUTPUT_ROUTINE<span style="mso-spacerun:
yes">  </span>ENDP

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">    
</span><span style="mso-spacerun: yes">  </span>000F<span style='mso-tab-count:
3'>             </span><span style="mso-spacerun: yes">      </span>CODE<span
style="mso-spacerun: yes">    </span>ENDS

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">      </span>END&#18;

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:3'>                  </span><span style="mso-spacerun:
yes">      </span>Фиг. 5.14 Процедура вывода

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>Рассмотрим эту же задачу с другой стороны.
Каким образом

<p><span
style="mso-spacerun: yes">    </span>редактор связей узнает о местоположении
внешних имен? На Фиг. 5.14

<p><span
style="mso-spacerun: yes">    </span>приведена подпрограмма, на которую
ссылается другая программа,

<p><span
style="mso-spacerun: yes">    </span>относящаяся к Фиг. 5.13. Переменные и
программные метки, на которые

<p><span
style="mso-spacerun: yes">    </span>имеются ссылки в программе, на Фиг. 5.13,
объявлены в подпрограмме

<p><span
style="mso-spacerun: yes">    </span>с помощью оператора PUBLIC. Это означает,
что их имена доступны для

<p><span
style="mso-spacerun: yes">    </span>другого программного модуля. Ни на какие
другие переменные или

<p><span
style="mso-spacerun: yes">    </span>программные метки в этой программе, не
указанные в операторе

<p><span
style="mso-spacerun: yes">    </span>PUBLIC, ссылки в других программах
невозможны. Хотя это может

<p><span
style="mso-spacerun: yes">    </span>показаться неудобным, однако, если все
имена имели бы атрибут

<p><span
style="mso-spacerun: yes">    </span>PUBLIC, то возникла бы другая трудность.
Это означало бы, что

<p><span
style="mso-spacerun: yes">    </span>каждое имя в любом из модулей, которые вы
могли бы связать между

<p><span
style="mso-spacerun: yes">    </span>собой, должны быть уникальными, т.е. вы
никогда бы не смогли

<p><span
style="mso-spacerun: yes">    </span>использовать одно и то же символическое
имя дважды в разных

<p><span
style="mso-spacerun: yes">    </span>модулях. Это может быть серьезным
препятствием для повторного

<p><span
style="mso-spacerun: yes">    </span>использования некоторых подпрограмм, так
как такое использование

<p><span
style="mso-spacerun: yes">    </span>возможно и через несколько лет, а помнить
все символические имена и

<p><span
style="mso-spacerun: yes">    </span>следить за тем, чтобы ни одно из них не
повторялось дважды довольно

<p><span
style="mso-spacerun: yes">    </span>сложно. Заметьте, что в операторе PUBLIC
не требуется указывать

<p><span
style="mso-spacerun: yes">    </span>атрибуты имен: об этом заботятся обычные
операторы языка

<p><span
style="mso-spacerun: yes">    </span>ассемблера.

<p><span
style='mso-tab-count:1'>      </span>Программа LINK устанавливает соответствие
между всеми внешними

<p><span
style="mso-spacerun: yes">    </span>именами и соответствующими операторами
PUBLIC, которые их

<p><span
style="mso-spacerun: yes">    </span>объявляют. После этого редактор связей
записывает правильные

<p><span
style="mso-spacerun: yes">    </span>значения адресов в команды, гдк есть
ссылки на внешние имена.

<p><span
style="mso-spacerun: yes">    </span>Обрабатываются те поля в командах, рядом с
которыми в ассемблерном

<p><span
style="mso-spacerun: yes">    </span>листинге стоял символ &quot;E&quot;.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>Кроме того, ассемблер осуществляет
объединение любых сегментов

<p><span
style="mso-spacerun: yes">    </span>с одними тем же именем. В случае программ
на Фиг. 5.13 и П5.14

<p><span
style="mso-spacerun: yes">    </span>основная программа и подпрограмма
принадлежат одному и тому же

<p><span
style="mso-spacerun: yes">    </span>сегменту с именем CODE. Так как в
операторе EXTRN основной

<p><span
style="mso-spacerun: yes">    </span>программы для программы OUTPUT_ROUTINE
указан атрибут NEAR, то

<p><span
style="mso-spacerun: yes">    </span>желательно, чтобы эта программа была в том
же сегменте. Атрибут

<p><span
style="mso-spacerun: yes">    </span>PUBLIC в операторе SEGMENT указывает
редактору связей объединить

<p><span
style="mso-spacerun: yes">    </span>оба программных модуля в один выполняемый
сегмент.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>В программе на Фиг. 5.13 есть еще один
сегмент, который следует

<p><span
style="mso-spacerun: yes">    </span>рассмотреть. Данная программа выполняется
как программа типа .EXE.

<p><span
style="mso-spacerun: yes">    </span>При передаче управления программе типа
.EXE система DOS организует

<p><span
style="mso-spacerun: yes">    </span>для этой программы стек. Информация для
стека поступает от

<p><span
style="mso-spacerun: yes">    </span>редактора связей, который записывает ее в
головную метку файла типа

<p><span
style="mso-spacerun: yes">    </span>.EXE. Подготовить все для стека обязан
программист. Если он этого

<p><span
style="mso-spacerun: yes">    </span>не сделает, то редактор связей выдает
соответствующее сообщение. В

<p><span
style="mso-spacerun: yes">    </span>обычной ситуации это не может служить
препятствием для выполнения

<p><span
style="mso-spacerun: yes">    </span>программы. Однако в таком случае параметры
стека для программы

<p><span
style="mso-spacerun: yes">    </span>выбираются по умолчанию, т.е.
местоположение и размер стека могут

<p><span
style="mso-spacerun: yes">    </span>оказаться неподходящими. За подготовку
стека отвечает сегмент

<p><span
style="mso-spacerun: yes">    </span>STACK, входящий в программу на Фиг.5.13.
Его имя STACK и задание

<p><span
style="mso-spacerun: yes">    </span>соответствующего атрибута равным STACK
говорят о том, что это

<p><span
style="mso-spacerun: yes">    </span>область памяти предназначена для стека.
Редактор связей, кроме

<p><span
style="mso-spacerun: yes">    </span>того, проверяет, правильно ли установлен
указатель стека в момент,

<p><span
style="mso-spacerun: yes">    </span>когда управление передается программе.
<p><div align="center"><a href="index.html"><img src="../soder.gif" width=120 height=31 border=0 alt=""></a></div></p>
</body>
</html>
