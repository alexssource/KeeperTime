<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
	<title>Untitled</title>
</head>

<body background="../bgrwhite.gif">


<p><div align="center"><b><font size="+1"><i>	
<a name="6-6">Команды INCLUDE</a></i></font></b></div></p>

<p><span
style="mso-spacerun: yes">    </span>Оператор ассемблера INCLUDE осуществляет
вставку текста из другого

<p><span
style="mso-spacerun: yes">    </span>файла в транслируемую программу. Оператор
INCLUDE особенно удобен в

<p><span
style="mso-spacerun: yes">    </span>случае работы с набором макрокоманд,
например, макрокомандами

<p><span
style="mso-spacerun: yes">    </span>сопроцессора 8087. Все команды
сопроцессора 8087 представлены

<p><span
style="mso-spacerun: yes">    </span>макрокомандами. Весь такой набор
макрокоманд или какое-то его под-

<p><span
style="mso-spacerun: yes">    </span>множемтво вам приходится включать в любую
транслируемую программу,

<p><span
style="mso-spacerun: yes">    </span>где применяется сопроцессор 8087. Однако
копировать эти макроко-

<p><span
style="mso-spacerun: yes">    </span>манды в каждый исходный файл неудобно.
Кроме того, они занимают

<p><span
style="mso-spacerun: yes">    </span>столько места, что исходные файлы быстро
заполнили бы всю вашу дис-

<p><span
style="mso-spacerun: yes">    </span>кету, если бы вы попытались копировать
макрокоманды в каждый файл.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>Эта проблема решается в языке ассемблера с
помощью оператора

<p><span
style="mso-spacerun: yes">    </span>INCLUDE. Оператор

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>ICLUDE<span style='mso-tab-count:1'>      </span>имяфайла

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style="mso-spacerun: yes">      </span>считывает указанный файл и включает его
как часть в ассемблируемую

<p><span
style="mso-spacerun: yes">    </span>программу. Ассемблер помещает нужный файл
в то место, где

<p><span
style="mso-spacerun: yes">    </span>расположен оператор INCLUDE. Оператор
INCLUDE естественно

<p><span
style="mso-spacerun: yes">    </span>использовать по отношению к библиотекам
макрокоманд, например,

<p><span
style="mso-spacerun: yes">    </span>макрокоманд сопроцессора 8087. Вы
помещаете оператор INCLUDE в

<p><span
style="mso-spacerun: yes">    </span>начало программы - и любая команда
сопроцессора 8087 в вашей

<p><span
style="mso-spacerun: yes">    </span>программе будет ассемблироваться
правильно.

<p><span
style='mso-tab-count:1'>      </span>Аналогично, вы можете использовать
оператор INCLUDE для

<p><span
style="mso-spacerun: yes">    </span>подключения других частей программы. Если
вы захотите разбить вашу

<p><span
style="mso-spacerun: yes">    </span>программу на меньшие исходные файлы, но
ассемблировать ее как один

<p><span
style="mso-spacerun: yes">    </span>файл, то главный исходный файл может
состоять из операторов INCLUDE

<p><span
style="mso-spacerun: yes">    </span>для всех вспомогательных исходных файлов.
Однако как было показано

<p><span
style="mso-spacerun: yes">    </span>в гл.5, ассемблирование небольших модулей
и связывание их с помощью

<p><span
style="mso-spacerun: yes">    </span>программы LINK в большинстве случаев
предпочтительнее.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>Другой вариант для использования оператора
INCLUDE - структура

<p><span
style="mso-spacerun: yes"> </span><span style="mso-spacerun: yes">  
</span>данных. Вы можете использовать некоторую структуру данных в

<p><span
style="mso-spacerun: yes">    </span>нескольких программах. Определение этой
структуры данных можно

<p><span
style="mso-spacerun: yes">    </span>хранить в виде отдельного файла, и с
помощью оператора INCLUDE

<p><span
style="mso-spacerun: yes">    </span>обращаться к ней из любой программы, где
они требуются. Далее в

<p><span
style="mso-spacerun: yes">    </span>этой главе мы рассмотрим способы, с
помощью которых программа может

<p><span
style="mso-spacerun: yes">    </span>задавать и использовать структуры данных.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>Если включаемый файл является файлом
макроопределений, то не

<p><span
style="mso-spacerun: yes">    </span>имеет смысла, чтобы он появлялся в
ассемблерном листинге каждый раз

<p><span
style="mso-spacerun: yes">    </span>при трансляции программы. Чтобы исключить
макроопределения из

<p><span
style="mso-spacerun: yes">    </span>листинга, но сохранить их для генерации
программного кода, вы

<p><span
style="mso-spacerun: yes">    </span>можете воспользоваться условным оператором
IF1. Последовательность

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style="mso-spacerun: yes">      </span>IF1

<p><span
style="mso-spacerun: yes">      </span>INCLUDE<span style='mso-tab-count:1'>     </span>87MAC.LIB

<p><span
style="mso-spacerun: yes">      </span>ENDM

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style="mso-spacerun: yes">      </span>приводит к включению в программу файла
87MAC.LIB при первом

<p><span
style="mso-spacerun: yes">    </span>проходе ассемблера. Именно во время
первого прохода ассемблер

<p><span
style="mso-spacerun: yes">    </span>осуществляет расширение всех макрокоманд
до их окончательной формы.

<p><span
style="mso-spacerun: yes">    </span>При втором проходе макроопределения
ассемблеру не нужны. Это

<p><span
style="mso-spacerun: yes">    </span>ускоряет процесс ассемблирования, так как
во время второго прохода

<p><span
style="mso-spacerun: yes">    </span>файл макрокоманд не считывается. Ассемблер
не печатает файл

<p><span
style="mso-spacerun: yes">    </span>макрокоманд, так как листинговый файл
формируется при втором

<p><span
style="mso-spacerun: yes">    </span>проходе. На Фиг. 6.11 показано
использование в программе

<p>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>Microsoft (R) Macro Assembler Version 5.00<span style='mso-tab-count:
2'>           </span><span style="mso-spacerun: yes">   </span>1/1/80 01:21:40

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>Фиг. 6.11 Вставка макроопределений для 8087<span style='mso-tab-count:
2'>          </span><span style="mso-spacerun: yes">   </span>Page<span
style="mso-spacerun: yes">     </span>1-1

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">       </span>PAGE<span style="mso-spacerun: yes">   
</span>,132

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">       </span>TITLE<span style="mso-spacerun: yes">  
</span>Фиг. 6.11 Вставка макроопределений для 8087

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:2'>            </span>0000<span style='mso-tab-count:3'>              </span><span
style="mso-spacerun: yes">       </span>CODE<span style="mso-spacerun: yes">   
</span>SEGMENT

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">       </span>ASSUME<span style="mso-spacerun: yes"> 
</span>CS:CODE,DS:CODE

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:2'>            </span>0000<span style="mso-spacerun:
yes">  </span>????<span style='mso-tab-count:2'>        </span><span
style="mso-spacerun: yes">       </span>TWO_BYTE<span style="mso-spacerun:
yes">        </span>DW<span style="mso-spacerun: yes">      </span>?

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:2'>            </span>0002<span style="mso-spacerun:
yes">  </span>9B DB E0<span style='mso-tab-count:3'>                </span><span
style="mso-spacerun: yes">       </span>FENI

<p><span
style='mso-tab-count:2'>            </span>0005<span style="mso-spacerun:
yes">  </span>9B DE 3E 0000 R<span style='mso-tab-count:2'>         </span><span
style="mso-spacerun: yes">       </span>FIDIVR<span style="mso-spacerun: yes"> 
</span>TWO_BYTE

<p><span
style='mso-tab-count:2'>            </span>000A<span style="mso-spacerun:
yes">  </span>9B D9 C1<span style='mso-tab-count:3'>                </span><span
style="mso-spacerun: yes">       </span>FLD

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:2'>            </span>000D<span style='mso-tab-count:3'>              </span><span
style="mso-spacerun: yes">       </span>CODE<span style="mso-spacerun: yes">   
</span>ENDS

<p><span
style='mso-tab-count:6'>                                    </span><span
style="mso-spacerun: yes">       </span>END&#18;

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">      
</span>Фиг. 6.11 Вставка макроопределений для 8087

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style="mso-spacerun: yes">    </span>последовательности IF1 ... INCLUDE ...
ENDM для макрокоманд

<p><span
style="mso-spacerun: yes">    </span>сопроцессора 8087. Приведены как исходный,
так и листинговый файлы

<p><span
style="mso-spacerun: yes">  </span><span style="mso-spacerun:
yes">  </span>данной программы. Ассемблер правильно обрабатывает команды

<p><span
style="mso-spacerun: yes">    </span>сопроцессора 8087, опуская печать
определений соответствующих

<p><span
style="mso-spacerun: yes">    </span>макрокоманд.

<p><div align="center"><a href="index.html"><img src="../soder.gif" width=120 height=31 border=0 alt=""></a></div></p>
</body>
</html>
