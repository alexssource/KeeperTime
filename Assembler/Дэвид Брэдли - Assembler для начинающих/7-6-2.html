<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
	<title>Untitled</title>
</head>
<body background="../bgrwhite.gif">
<p><div align="center"><b><a name="7-6-2">Управляющее слово
</a></b></div></p>

<p><span
style='mso-tab-count:1'>      </span>Сопроцессор 8087 содержит два управляющих
регистра.<span style="mso-spacerun: yes">  </span>Один

<p><span
style="mso-spacerun: yes">    </span>регистр нужен для записи управляющего
слова, другой - для

<p><span
style="mso-spacerun: yes">    </span>считывания слова состояния.<span
style="mso-spacerun: yes">  </span>Управляющий регистр позволяет

<p><span
style="mso-spacerun: yes">    </span>программисту задать режим рабоиы
микросхемы 8087, далее о

<p><span
style="mso-spacerun: yes">    </span>возможностях некоторых из них будет лишь
упомянуто; рассомтрение

<p><span
style="mso-spacerun: yes">    </span>всех возможных вариаций управляющего слова
выходит за пределя этой

<p><span
style="mso-spacerun: yes">    </span>книги.<span style="mso-spacerun: yes"> 
</span>Структура управляющего регистра показана на Фиг. 7.7.

<p><span
style='mso-tab-count:1'>      </span>Управляющее слово позволяет выбрать один
из двух различных

<p><span
style="mso-spacerun: yes">    </span>типов бесконечности.<span
style="mso-spacerun: yes">  </span>По умолчанию способом замыкания числовой


<p><span
style="mso-spacerun: yes">    </span>системы является проективное замыкание,
при котором сопроцессор

<p><span
style="mso-spacerun: yes">    </span>8087 трактует положительную, и
отрицательную бесконечности как

<p><span
style="mso-spacerun: yes">    </span>единую бесконечность без знака.<span
style="mso-spacerun: yes">  </span>Другой способ - аффинное

<p><span
style="mso-spacerun: yes">    </span>замыкание, в которое входят и
положительная, и отрицательная

<p><span
style="mso-spacerun: yes">    </span>бесконечности.<span style="mso-spacerun:
yes">  </span>Хотя может показаться, что проективное замыкание

<p><span
style="mso-spacerun: yes">    </span>теряет информацию, оно никогда не приводит
к бессмысленным

<p><span
style="mso-spacerun: yes">    </span>результатам.<span style="mso-spacerun:
yes">  </span>Аффинное замыкание в программе необходимо

<p><span
style="mso-spacerun: yes">    </span>использовать только тогда, когда
неоюходима дополнительная

<p><span
style="mso-spacerun: yes">    </span>информация и когда программа написана для
того, чтобы иметь дело с

<p><span
style="mso-spacerun: yes">    </span>(возможно) неверными результатами.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>Сопроцессор 8087 позволяет выбрать один из
четырех способов

<p><span
style="mso-spacerun: yes">    </span>округления чисел.<span
style="mso-spacerun: yes">  </span>Округление возникает тогда, когда результат


<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes"> </span>15<span
style='mso-tab-count:4'>                     </span><span style="mso-spacerun:
yes">  </span>7<span style='mso-tab-count:3'>               </span><span
style="mso-spacerun: yes">      </span>0

<p><span
style='mso-tab-count:1'>      </span>ЪДДДДДДДДДДДВДДДВДДДДДДДВДДДДДДДВДДДВДДДВДДДВДДДВДДДВДДДВДДДВДДДДї

<p><span
style='mso-tab-count:1'>      </span>і<span style='mso-tab-count:1'>     </span><span
style="mso-spacerun: yes">    </span>іIC і<span style="mso-spacerun: yes"> 
</span>RC<span style='mso-tab-count:1'>     </span>і<span style="mso-spacerun:
yes">  </span>PC<span style='mso-tab-count:1'> </span>іIEMі<span
style='mso-tab-count:1'> </span>іPM іUM іOM іZM іDM іIM<span
style="mso-spacerun: yes">  </span>і

<p><span
style='mso-tab-count:1'>      </span>АДДДБДДДБДДДБДДДБДДДБДДДБДДДБДДДБДДДБДДДБДДДБДДДБДДДБДДДБДДДБДДДДЩ

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun:
yes"> </span>ДДДДДВДДДДД<span style="mso-spacerun: yes">  </span>і<span
style="mso-spacerun: yes">  </span>ДДДВДДД<span style="mso-spacerun: yes"> 
</span>ДДВДД<span style="mso-spacerun: yes">   </span>і<span
style="mso-spacerun: yes">   </span>і<span style="mso-spacerun: yes">  
</span>і<span style="mso-spacerun: yes">   </span>і<span style="mso-spacerun:
yes">   </span>і<span style="mso-spacerun: yes">   </span>і<span
style="mso-spacerun: yes">   </span>і<span style="mso-spacerun: yes">   
</span>і МАСКИ ИСКЛЮЧЕНИЯ (1=МАСКИРУЕТСЯ)

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>і<span style="mso-spacerun: yes">       </span>і<span
style="mso-spacerun: yes">     </span>і<span style='mso-tab-count:1'>   </span><span
style="mso-spacerun: yes">    </span>і<span style='mso-tab-count:1'> </span><span
style="mso-spacerun: yes">  </span>і<span style="mso-spacerun: yes">  
</span>і<span style="mso-spacerun: yes">   </span>і<span style="mso-spacerun:
yes">   </span>і<span style="mso-spacerun: yes">   </span>і<span
style="mso-spacerun: yes">   </span>і<span style="mso-spacerun: yes">  
</span>і<span style="mso-spacerun: yes">    </span>АД<span style="mso-spacerun:
yes">  </span>НЕВЕРНАЯ ОПРЕАЦИЯ

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>і<span style="mso-spacerun: yes">       </span>і<span
style="mso-spacerun: yes">     </span>і<span style='mso-tab-count:1'>   </span><span
style="mso-spacerun: yes">    </span>і<span style='mso-tab-count:1'> </span><span
style="mso-spacerun: yes">  </span>і<span style="mso-spacerun: yes">  
</span>і<span style="mso-spacerun: yes">   </span>і<span style="mso-spacerun:
yes">   </span>і<span style="mso-spacerun: yes">   </span>і<span
style="mso-spacerun: yes">   </span>і<span style="mso-spacerun: yes">  
</span>АДДДДДД<span style="mso-spacerun: yes">  </span>НЕНОРМАЛИЗОВАННЫЙ
ОПЕРАНД

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>і<span style="mso-spacerun: yes">       </span>і<span
style="mso-spacerun: yes">     </span>і<span style='mso-tab-count:1'>   </span><span
style="mso-spacerun: yes">    </span>і<span style='mso-tab-count:1'> </span><span
style="mso-spacerun: yes">  </span>і<span style="mso-spacerun: yes">  
</span>і<span style="mso-spacerun: yes">   </span>і<span style="mso-spacerun:
yes">   </span>і<span style="mso-spacerun: yes">   </span>і<span
style="mso-spacerun: yes">   </span>АДДДДДДДДДД<span style="mso-spacerun:
yes">  </span>ДЕЛЕНИЕ НА НОЛЬ

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>і<span style="mso-spacerun: yes">       </span>і<span
style="mso-spacerun: yes">     </span>і<span style='mso-tab-count:1'>   </span><span
style="mso-spacerun: yes">    </span>і<span style='mso-tab-count:1'> </span><span
style="mso-spacerun: yes">  </span>і<span style="mso-spacerun: yes">  
</span>і<span style="mso-spacerun: yes">   </span>і<span style="mso-spacerun:
yes">   </span>і<span style="mso-spacerun: yes">   </span>АДДДДДДДДДДДДДД<span
style="mso-spacerun: yes">  </span>ПЕРЕПОЛНЕНИЕ

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>і<span style="mso-spacerun: yes">       </span>і<span
style="mso-spacerun: yes">     </span>і<span style='mso-tab-count:1'>   </span><span
style="mso-spacerun: yes">    </span>і<span style='mso-tab-count:1'> </span><span
style="mso-spacerun: yes">  </span>і<span style="mso-spacerun: yes">  
</span>і<span style="mso-spacerun: yes">   </span>і<span style="mso-spacerun:
yes">   </span>АДДДДДДДДДДДДДДДДДД<span style="mso-spacerun: yes"> 
</span>ИСЧЕЗАНИЕ ПОРЯДКА

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>і<span style="mso-spacerun: yes">       </span>і<span
style="mso-spacerun: yes">     </span>і<span style='mso-tab-count:1'>   </span><span
style="mso-spacerun: yes">    </span>і<span style='mso-tab-count:1'> </span><span
style="mso-spacerun: yes">  </span>і<span style="mso-spacerun: yes">  
</span>і<span style="mso-spacerun: yes">   </span>АДДДДДДДДДДДДДДДДДДДДДД<span
style="mso-spacerun: yes">  </span>ТОЧНОСТЬ

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>і<span style="mso-spacerun: yes">       </span>і<span
style="mso-spacerun: yes">     </span>і<span style='mso-tab-count:1'>   </span><span
style="mso-spacerun: yes">    </span>і<span style='mso-tab-count:1'> </span><span
style="mso-spacerun: yes">  </span>і<span style="mso-spacerun: yes">  
</span>АДДДДДДДДДДДДДДДДДДДДДДДДДД(ЗАРЕЗЕРВИРОВАНО)

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>і<span style="mso-spacerun: yes">       </span>і<span
style="mso-spacerun: yes">     </span>і<span style='mso-tab-count:1'>   </span><span
style="mso-spacerun: yes">    </span>і<span style='mso-tab-count:1'> </span><span
style="mso-spacerun: yes">  </span>АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДМАСКА
РАЗБЛОКИРОВКИ ПРЕРЫВАНИЙ (1)

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>і<span style="mso-spacerun: yes">       </span>і<span
style="mso-spacerun: yes">     </span>і<span style='mso-tab-count:1'>   </span><span
style="mso-spacerun: yes">   
</span>АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДУПРАВЛЕНИЕ ТОЧНОСТЬЮ (2)

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>і<span style="mso-spacerun: yes">       </span>і<span
style="mso-spacerun: yes">    
</span>АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДУПРАВЛЕНИЕ ОКРУГЛЕНИЕМ (3)

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>і<span style="mso-spacerun: yes">      
</span>АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДУПРАВЛЕНИЕ
НЕОПРЕДЕЛЕННОСТЬЮ (4)

<p><span
style='mso-tab-count:1'>      </span><span style="mso-spacerun: yes">     
</span>АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДД(ЗАРЕЗЕРВИРОВАНО)

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:4'>                        </span><span
style="mso-spacerun: yes">   </span>(1) Маска разблоктровки прерываний:

<p><span
style='mso-tab-count:5'>                              </span>0 = Разблокировка

<p><span
style='mso-tab-count:5'>                              </span>1 = Прерывания
заблокированы (маскированы)

<p><span
style='mso-tab-count:4'>                        </span><span
style="mso-spacerun: yes">   </span>(2) Управление точностью:

<p><span
style='mso-tab-count:5'>                              </span>00 = 24 бита

<p><span
style='mso-tab-count:5'>                              </span>01 =
(зарезервировано)

<p><span
style='mso-tab-count:5'>                              </span>10 = 53 бита

<p><span
style='mso-tab-count:5'>                              </span>11 = 64 бита

<p><span
style='mso-tab-count:4'>                        </span><span
style="mso-spacerun: yes">   </span>(3) Управление округлением:

<p><span
style='mso-tab-count:5'>                              </span>00 = Округление до
ближайшего или четного

<p><span
style='mso-tab-count:5'>                              </span>01 = Округление в
меньшую сторону

<p><span
style='mso-tab-count:5'>                              </span>10 = Округление в
болюшую сторону

<p><span
style='mso-tab-count:5'>                              </span>11 = Обрезание к
нулю

<p><span
style='mso-tab-count:4'>                        </span><span
style="mso-spacerun: yes">   </span>(4) Управление неопределенностью:

<p><span
style='mso-tab-count:5'>                              </span>0 = Прожективная

<p><span
style='mso-tab-count:5'>                              </span>1 = Афинитивная

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p>&#18;<span
style='mso-tab-count:1'>     </span><span style="mso-spacerun: yes">    
</span>Фиг. 7.7 Формат управляющего слова INTEL 8087

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style="mso-spacerun: yes">    </span>требует большей точности, чем позволяет
представление чисел.<span style="mso-spacerun: yes">  </span>Метод

<p><span
style="mso-spacerun: yes">    </span>округления определяет, какое число
выбирается в качестве

<p><span
style="mso-spacerun: yes">    </span>результата.<span style="mso-spacerun:
yes">  </span>Методы округления включают:<span style="mso-spacerun: yes"> 
</span>выбор следующего большего

<p><span
style="mso-spacerun: yes">    </span>числа в системе представления чисел,
следующего меньшего числа,

<p><span
style="mso-spacerun: yes">    </span>округление в направлении нуля, и
округление в направлении четного

<p><span
style="mso-spacerun: yes">    </span>числа.<span style="mso-spacerun: yes"> 
</span>Сопроцессор 8087 также дает возможность программе не

<p><span
style="mso-spacerun: yes">    </span>использовать полностью 64-битовую точность
временного

<p><span
style="mso-spacerun: yes">    </span>действительного формата ИИЭР.<span
style="mso-spacerun: yes">  </span>Эта возможность не уменьшает время

<p><span
style="mso-spacerun: yes">    </span>выполнения команд и не должна выполняться
только для того, чтобы

<p><span
style="mso-spacerun: yes">    </span>сделать команды процессора 8087
совместимыми с некоторыми

<p><span
style="mso-spacerun: yes">    </span>существовавшими ранее процедурами
обработки.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>Процессор 8087 может регистрировать
множество ситуаций

<p><span
style="mso-spacerun: yes">    </span>появления ошибки, известных как особые
ситуации; он также может

<p><span
style="mso-spacerun: yes">    </span>возбуждать прерывания, чтобы сообщить об
этих ситуациях.<span style="mso-spacerun: yes">  </span>В

<p><span
style="mso-spacerun: yes">    </span>управляющем слове имеется группа бит,
которая позволяет

<p><span
style="mso-spacerun: yes">    </span>программисту определить, какие особые
ситуации будут приводить к

<p><span
style="mso-spacerun: yes">    </span>прерываниям, а какие будут обрабатываться
другими способами.<span style="mso-spacerun: yes">  </span>Эти

<p><span
style="mso-spacerun: yes">    </span>биты известны как маски прерываний, так
как они могут маскировать,

<p><span
style="mso-spacerun: yes">    </span>или предотвращать, возникновение
прерываний.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>Необходимости разрешать прерывание в
каждой из этих ситуаций

<p><span
style="mso-spacerun: yes">    </span>нет.<span style="mso-spacerun: yes"> 
</span>Сопроцессор 8087 имеет широкие возможности по обработке

<p><span
style="mso-spacerun: yes">    </span>особых ситуаций, встроенных в него самого.<span
style='mso-tab-count:1'>  </span>Для любой возможной

<p><span
style="mso-spacerun: yes">    </span>ситуации в микросхеме 8087 имеется способ
обработки ее по

<p><span
style="mso-spacerun: yes">    </span>умолчанию.<span style='mso-tab-count:1'>    </span>Например,
деление на нуль вызывает прерывание по особой

<p><span
style="mso-spacerun: yes">    </span>ситуации, если она разрешена
(немаскирована).<span style="mso-spacerun: yes">  </span>Однако если

<p><span
style="mso-spacerun: yes">    </span>программист не разрешил это прерывание,
сопроцессор 8087 использует

<p><span
style="mso-spacerun: yes">    </span>значение бесконечности, как результат
деления на нуль.<span style="mso-spacerun: yes">  </span>Это

<p><span
style="mso-spacerun: yes">    </span>значение распространится через все
оставшиеся вычисления, давая

<p><span
style="mso-spacerun: yes">    </span>результат, непосредственно показывающий,
что во время работы

<p><span
style="mso-spacerun: yes">    </span>возникла ошибка некоторого вида.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>Иногда в какой-то из ваших программ,
использующих плавающую

<p><span
style="mso-spacerun: yes">    </span>точку, может оказаться необходимым
обрабатывать особую ситуацию

<p><span
style="mso-spacerun: yes">    </span>сразу же, как она возникает; и тогда у вас
возникает желание

<p><span
style="mso-spacerun: yes">    </span>заменить обработчик прерываний вашей
собственной подпрограммой,

<p><span
style="mso-spacerun: yes">    </span>обрабатывающей особые ситуации.<span
style="mso-spacerun: yes">  </span>В IBM PC вывод прерывания по

<p><span
style="mso-spacerun: yes">    </span>особой ситуации от микросхемы 8087
подключен ко входу

<p><span
style="mso-spacerun: yes">    </span>немаскируемого прерывания NMI (Non
Maskable Interrupt).<span style="mso-spacerun: yes">  </span>Это то же

<p><span
style="mso-spacerun: yes">    </span>самое прерывание, которое сигнализирует об
ошибке четности.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>В качестве примера особой ситуации
рассмотрим упомянутое выше

<p><span
style="mso-spacerun: yes">    </span>переполнение стека.<span
style="mso-spacerun: yes">  </span>Если программа помещает в стек девятый
объект,

<p><span
style="mso-spacerun: yes">    </span>сопроцессор 8087 отвечает прерыванием по
особой ситуации.<span style="mso-spacerun: yes">  </span>Если это

<p><span
style="mso-spacerun: yes">    </span>прерывание не разрешено, сопроцессор 8087
отмечает операцию как

<p><span
style="mso-spacerun: yes">    </span>недействительную и дает результат со
специальным значением,

<p><span
style="mso-spacerun: yes">    </span>известным как NAN (Not A Number, не
число).<span style="mso-spacerun: yes">  </span>Если вы собираетесь

<p><span
style="mso-spacerun: yes">    </span>выполнять сложные вычисления, требующие
более восьми позиций стека,

<p><span
style="mso-spacerun: yes">    </span>то можете выгодно использовать прерывание
по этой особой ситуации.

<p><span
style="mso-spacerun: yes">    </span>Когда возникает переполнение стека,
обработчик этого прерывания

<p><span
style="mso-spacerun: yes">    </span>может удалить нижние элементы стека,
используя команды записи.

<p><span
style="mso-spacerun: yes">    </span>Затем программа освобождает эти позиции
стека для дальнейшего

<p><span
style="mso-spacerun: yes">    </span>использования.<span style="mso-spacerun:
yes">  </span>Существует также и соответствующее прерывание по

<p><span
style="mso-spacerun: yes">    </span>исчерпыванию стека, которое возникает при
использовании пустой

<p><span
style="mso-spacerun: yes">    </span>позиции стека; подпрограмма обработки
прерывания может обрабатывать

<p><span
style="mso-spacerun: yes">    </span>и эту ситуацию:<span style="mso-spacerun:
yes">  </span>она может восстановить прежнее состояние стека из

<p><span
style="mso-spacerun: yes">    </span>области сохранения.

<p><![if !supportEmptyParas]>&nbsp;<![endif]>

<p><span
style='mso-tab-count:1'>      </span>Далее мы увидим, что микросхема 8087
содержит информацию о

<p><span
style="mso-spacerun: yes">    </span>своем состоянии, что делает возможным
обработать особые ситуации в

<p><span
style="mso-spacerun: yes">    </span>обработчике прерываний.<span
style="mso-spacerun: yes">  </span>Микросхема 8087 имеет исчерпывающую

<p><span
style="mso-spacerun: yes">    </span>информацию о команде, которая вызвала
особую ситуацию.

<p><div align="center"><a href="index.html"><img src="../soder.gif" width=120 height=31 border=0 alt=""></a></div></p>
</body>
</html>
